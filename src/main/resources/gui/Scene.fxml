<?xml version="1.0" encoding="UTF-8"?>
<?import java.lang.String?>
<?import javafx.collections.FXCollections?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<StackPane fx:id="rootPane" prefHeight="600.0" prefWidth="335.0" style="-fx-background-color: transparent;" xmlns="http://javafx.com/javafx/21.0.2" xmlns:fx="http://javafx.com/fxml/1" fx:controller="gui.GUI_SceneController">
   <children>
      <ImageView fitHeight="600.0" fitWidth="335.0">
         <image>
            <Image url="@/gui/images/Cover1.png" />
         </image>
      </ImageView>
      <VBox fx:id="loginPane" spacing="12.0" alignment="TOP_CENTER" maxWidth="295.0" style="-fx-background-color: transparent; -fx-background-radius: 10; -fx-padding: 24 24 24 24;">
         <StackPane.margin>
            <Insets top="220" />
         </StackPane.margin>
         <children>
            <Label text="Welcome to Furry Friends!" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-background-color: transparent;" />
            <TextField fx:id="usernameField" promptText="Username" maxWidth="250.0" style="-fx-background-color: transparent; -fx-border-color: black; -fx-border-width: 1; -fx-prompt-text-fill: #222;"/>
            <PasswordField fx:id="passwordField" promptText="Password" maxWidth="250.0" style="-fx-background-color: transparent; -fx-border-color: black; -fx-border-width: 1; -fx-prompt-text-fill: #222;"/>
            <Button text="Login" fx:id="loginButton" onAction="#handleLogin" maxWidth="250.0" style="-fx-background-color: transparent;"/>
            <Button text="Register" fx:id="registerButton" onAction="#showRegisterPane" maxWidth="250.0" style="-fx-background-color: transparent;"/>
            <Button text="Forgot Password or UserID" fx:id="forgotButton" onAction="#showForgotPane" maxWidth="250.0" style="-fx-background-color: transparent;"/>
            <Button text="Exit" fx:id="exitButton" onAction="#handleExit" maxWidth="250.0" style="-fx-background-color: transparent;"/>
            <Label fx:id="messageLabel" textFill="red" wrapText="true" maxWidth="250.0" style="-fx-background-color: transparent;"/>
         </children>
      </VBox>
      <VBox fx:id="registerPane" visible="false" managed="false" alignment="CENTER" spacing="12.0" maxWidth="295.0" style="-fx-background-color: transparent; -fx-background-radius: 10; -fx-padding: 24 24 24 24;">
         <StackPane.margin>
            <Insets top="220" />
         </StackPane.margin>
         <children>
            <Label text="Register New Account" style="-fx-font-size: 18px; -fx-font-weight: bold; -fx-background-color: transparent;" />
            <ComboBox fx:id="regRoleBox" promptText="Select Account Type">
                <items>
                    <FXCollections fx:factory="observableArrayList">
                        <String fx:value="Owner" />
                        <String fx:value="Vet Hospital" />
                        <String fx:value="Shelter" />
                    </FXCollections>
                </items>
            </ComboBox>
            <VBox fx:id="userStep1Box" spacing="8.0">
                <TextField fx:id="regUsernameField" promptText="Username" style="-fx-background-color: transparent; -fx-border-color: black; -fx-border-width: 1; -fx-prompt-text-fill: #222;" />
                <PasswordField fx:id="regPasswordField" promptText="Password" style="-fx-background-color: transparent; -fx-border-color: black; -fx-border-width: 1; -fx-prompt-text-fill: #222;" />
                <TextField fx:id="regEmailField" promptText="Email" />
                <TextField fx:id="regFirstNameField" promptText="First Name" />
                <TextField fx:id="regLastNameField" promptText="Last Name" />
                <Button text="Next" onAction="#showUserStep2" />
            </VBox>
            <VBox fx:id="userStep2Box" spacing="8.0" visible="false" managed="false">
                <TextField fx:id="regStreetField" promptText="Street" />
                <TextField fx:id="regCityField" promptText="City" />
                <TextField fx:id="regStateField" promptText="State" />
                <TextField fx:id="regZipField" promptText="Zip" />
                <TextField fx:id="regPhoneField" promptText="Phone Number" />
                <Button text="Register" onAction="#submitRegister" />
            </VBox>
            <Button text="Back to Login" onAction="#showLoginPane" />
            <Label fx:id="regMessageLabel" textFill="red" />
         </children>
      </VBox>
      <VBox fx:id="forgotPane" visible="false" managed="false" alignment="CENTER" spacing="12.0" style="-fx-background-color: transparent; -fx-padding: 40 20 20 20;" maxWidth="295.0">
         <StackPane.margin>
            <Insets top="220" />
         </StackPane.margin>
         <children>
            <Label text="Forgot Password" style="-fx-font-size: 18px; -fx-font-weight: bold;" />
            <TextField fx:id="forgotUsernameField" promptText="Username" style="-fx-background-color: transparent; -fx-border-color: black; -fx-border-width: 1; -fx-prompt-text-fill: #222;" />
            <TextField fx:id="forgotEmailField" promptText="Email" />
            <PasswordField fx:id="forgotNewPasswordField" promptText="New Password" style="-fx-background-color: transparent; -fx-border-color: black; -fx-border-width: 1; -fx-prompt-text-fill: #222;" />
            <Button text="Reset Password" onAction="#submitForgotPassword" />
            <Button text="Back to Login" onAction="#showLoginPane" />
            <Label fx:id="forgotMessageLabel" textFill="red" />
         </children>
      </VBox>
   <VBox fx:id="userMenuPane" visible="false" managed="false" alignment="TOP_CENTER" maxWidth="295.0" spacing="20.0" style="-fx-background-color: transparent; -fx-background-radius: 10; -fx-padding: 24 24 24 24;">
         <StackPane.margin>
            <Insets top="220" />
         </StackPane.margin>
         <children>
            <Label fx:id="welcomeLabel" text="Welcome!" style="-fx-font-size: 20px; -fx-font-weight: bold; -fx-background-color: transparent;" />
            <Label fx:id="userInfoLabel" text="User info will appear here." style="-fx-background-color: transparent;" />
         <HBox fx:id="vetShelterActions" spacing="8.0" alignment="CENTER" visible="false" managed="false">
            <Button text="Add Sample Slots" onAction="#handleAddSampleSlots">
               <tooltip>
                  <Tooltip text="Add a couple of example time slots to your facility" />
               </tooltip>
            </Button>
            <Button text="View Open Slots" onAction="#handleListMySlots">
               <tooltip>
                  <Tooltip text="See your facility's time slots (OPEN or BOOKED)" />
               </tooltip>
            </Button>
            <Button text="View Appointments" onAction="#handleViewFacilityAppointments">
               <tooltip>
                  <Tooltip text="See scheduled appointments (and shelter bookings if you're a Shelter)" />
               </tooltip>
            </Button>
            <Button fx:id="bookShelterRoomButton" text="Book Shelter Room" onAction="#handleBookShelterRoom">
               <tooltip>
                  <Tooltip text="Shelter: view bookings. Vet: book a shelter room on an available date." />
               </tooltip>
            </Button>
            <Button text="Seed Rooms/Dates" onAction="#handleSeedShelterRooms">
               <tooltip>
                  <Tooltip text="Create a demo shelter room and a couple of available dates" />
               </tooltip>
            </Button>
         </HBox>

         <HBox fx:id="ownerActions" spacing="8.0" alignment="CENTER" visible="false" managed="false">
            <Button text="See Open Vet Slots &amp; Book" onAction="#handleBookAppointment">
               <tooltip>
                  <Tooltip text="Browse available vet hospital slots and book an appointment" />
               </tooltip>
            </Button>
            <Button text="My Appointments" onAction="#handleMyAppointments">
               <tooltip>
                  <Tooltip text="View your upcoming and past appointments" />
               </tooltip>
            </Button>
            <Button text="My Pets" onAction="#handleMyPets">
               <tooltip>
                  <Tooltip text="List your pets and copy their IDs for quick actions" />
               </tooltip>
            </Button>
         </HBox>

         <TitledPane fx:id="adminPanel" text="Facility Admin" expanded="false" visible="false" managed="false" maxWidth="280.0">
            <content>
               <ScrollPane fitToWidth="true" prefViewportHeight="220.0" prefViewportWidth="260.0">
                  <content>
                     <VBox spacing="8.0">
                        <padding>
                           <Insets top="10.0" right="10.0" bottom="10.0" left="10.0" />
                        </padding>
                  <Label text="Facility Name" />
                  <TextField fx:id="adminFacilityName" />
                  <Label text="Phone" />
                  <TextField fx:id="adminPhone" />
                  <Label text="Street" />
                  <TextField fx:id="adminStreet" />
                  <Label text="City, State ZIP" />
                  <HBox spacing="6.0">
                     <TextField fx:id="adminCity" promptText="City" />
                     <TextField fx:id="adminState" promptText="State" maxWidth="60" />
                     <TextField fx:id="adminZip" promptText="Zip" maxWidth="80" />
                  </HBox>
                  <Label text="Email" />
                  <TextField fx:id="adminEmail" />
                  <Label text="Business Hours" />
                  <TextField fx:id="adminHours" />
                  <Label text="Website" />
                  <TextField fx:id="adminWebsite" />
                  <HBox spacing="8.0">
                     <Button text="Save Facility" onAction="#handleAdminSaveFacility" />
                     <Region />
                  </HBox>
                  <Separator />
                  <Label text="Add Custom Slot (YYYY-MM-DDTHH:MM)" />
                  <HBox spacing="6.0">
                     <TextField fx:id="adminCustomSlot" promptText="2025-09-16T09:30" />
                     <Button text="Add Slot" onAction="#handleAdminAddCustomSlot" />
                  </HBox>
                     </VBox>
                  </content>
               </ScrollPane>
            </content>
         </TitledPane>

         <!-- Vet/Shelter: Lookup Owner & Pets -->
         <TitledPane fx:id="lookupPanel" text="Owner &amp; Pets Lookup" expanded="false" visible="false" managed="false" maxWidth="280.0">
            <content>
               <VBox spacing="8.0">
                  <Label text="Enter Owner Username" />
                  <HBox spacing="6.0">
                     <TextField fx:id="lookupOwnerField" promptText="ownerLoginId" />
                     <Button text="Lookup" onAction="#handleLookupOwnerAndPets" />
                  </HBox>
                  <TextArea fx:id="lookupResults" prefRowCount="8" wrapText="true" editable="false" />

                  <Separator />
                  <Label text="Patient Medical History" />
                  <HBox spacing="6.0">
                     <TextField fx:id="petHistoryPetIdField" promptText="Pet ID (e.g., 1)" />
                     <Button text="Copy ID" onAction="#handleCopyPetHistoryId" />
                     <Button text="Show History" onAction="#handleShowPetHistory" />
                  </HBox>
                  <TextArea fx:id="petHistoryResults" prefRowCount="6" wrapText="true" editable="false" />
               </VBox>
            </content>
         </TitledPane>

         <!-- Emergency Dispatch -->
         <TitledPane fx:id="emergencyPanel" text="Emergency Dispatch" expanded="false" visible="false" managed="false" maxWidth="280.0">
            <content>
               <VBox spacing="8.0">
                  <Label text="Simulate an emergency intake and dispatch workflow." />
                  <HBox spacing="6.0">
                     <TextField fx:id="emergencyPetNameField" promptText="Pet name (optional)" />
                     <Button text="Dispatch Now" onAction="#handleEmergencyDispatch" />
                  </HBox>
                  <TextArea fx:id="emergencyOutput" prefRowCount="6" wrapText="true" editable="false" />
               </VBox>
            </content>
         </TitledPane>
            <Button text="Logout" onAction="#handleLogout" style="-fx-background-color: transparent;" />
         </children>
      </VBox>
   </children>
   <!-- Toast notification overlay (initially hidden) -->
   <StackPane fx:id="notificationOverlay" visible="false" managed="false" opacity="0.0" StackPane.alignment="BOTTOM_CENTER">
      <StackPane.margin>
         <Insets bottom="18" />
      </StackPane.margin>
      <children>
         <Label fx:id="notificationLabel" textFill="white" style="-fx-font-size: 12px; -fx-font-weight: bold;" />
      </children>
   </StackPane>
</StackPane>